import{S as T,a as q}from"./request-94b62179.js";import{r as l,u as G,a as j,b as R,c as V,w as W,d as e,E as b,G as x,e as w,p as A,j as z}from"./index-4356cc2a.js";import{_ as J}from"./camera-cf08fdea.js";import{m as K}from"./mainHeader-019bed70.js";import{f as Q,m as N}from"./plugin-vueexport-helper-e59a4b14.js";const n=d=>(A("data-v-3eab6b95"),d=d(),z(),d),X={class:"page"},Y=["src"],Z=n(()=>e("img",{class:"camera-image place-self-center",src:J},null,-1)),$=[Z],ee={class:"slider-section"},te=n(()=>e("div",null,"How much food did you finish overall?",-1)),ae={class:"flex justify-between"},se={class:"slider-section"},le=n(()=>e("div",null,"How much rice/noodle did you finish?",-1)),ne={class:"flex justify-between"},ie={class:"slider-section"},oe=n(()=>e("div",null,"How much vegetable did you finish?",-1)),ce={class:"flex justify-between"},re={class:"slider-section"},de=n(()=>e("div",null,"How much meat did you finish?",-1)),ue={class:"flex justify-between"},pe=n(()=>e("div",{class:"text-gray-400 text-xs mx-6"}," * For not applicable food type, please select 100% ",-1)),me={__name:"Create",setup(d){const u=l(90),p=l(90),m=l(90),v=l(90),k=l();let C=null;const S=l(null),F=l(!1),U=()=>{S.value.click()},D=async a=>{let t=a.target.files[0];const i=await P(t,{quality:1,type:"image/jpeg"});k.value=URL.createObjectURL(t),C=i},P=async(a,{quality:t=1,type:i=a.type})=>new Promise((s,ve)=>{let H=new FileReader;H.onloadend=function(M){var o=new Image;o.src=M.target.result,o.style.imageOrientation="from-image",o.onload=async function(_e){let{width:c,height:r}=o,_=400,f=400,h=c,g=r;(c>_||r>f)&&(c/r>_/f?(h=_,g=Math.round(_*(r/c))):(g=f,h=Math.round(f*(c/r))));var y=document.createElement("canvas");y.width=h,y.height=g;var E=y.getContext("2d");E.drawImage(o,0,0,h,g);const I=await new Promise(O=>y.toBlob(O,i,t));s(new File([I],a.name,{type:I.type}))}},H.readAsDataURL(a)}),B=G(),L=async()=>{if(C===null){N.error("Please take a photo first");return}F.value=!0;let a=new FormData;a.append("pic",C),a.append("rice",Number(p.value)),a.append("vegetable",Number(m.value)),a.append("meat",Number(v.value)),a.append("overall",Number(u.value));let t=await q("post","feedback",a,!0,{"Content-Type":"multipart/form-data"});F.value=!1,t.error===!1&&(N.success("successfully submitted!"),B.push({path:"/"}))};return(a,t)=>{const i=T;return j(),R("div",X,[V(K),V(i,{spinning:F.value,tip:"submitting"},{default:W(()=>[e("input",{ref_key:"uploadFile",ref:S,type:"file",style:{display:"none"},accept:"image/*",capture:"camera",name:"file",onChange:D},null,544),k.value?(j(),R("img",{key:0,class:"pic-preview",src:k.value,onClick:U},null,8,Y)):(j(),R("div",{key:1,class:"pic-placehoder flex place-content-center",onClick:U},$)),e("div",ee,[te,e("div",ae,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),class:"slider overall place-self-center"},null,512),[[x,u.value]]),e("div",null,w(u.value)+"%",1)])]),e("div",se,[le,e("div",ne,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),class:"slider rice place-self-center"},null,512),[[x,p.value]]),e("div",null,w(p.value)+"%",1)])]),e("div",ie,[oe,e("div",ce,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),class:"slider vegetable place-self-center"},null,512),[[x,m.value]]),e("div",null,w(m.value)+"%",1)])]),e("div",re,[de,e("div",ue,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[3]||(t[3]=s=>v.value=s),class:"slider meat place-self-center"},null,512),[[x,v.value]]),e("div",null,w(v.value)+"%",1)])]),pe,e("div",{class:"btn place-content-center text-white text-xl text-center",onClick:L}," Submit ")]),_:1},8,["spinning"])])}}},xe=Q(me,[["__scopeId","data-v-3eab6b95"]]);export{xe as default};

import{S as q,a as E}from"./request-b35818e7.js";import{r as l,u as W,a as I,c as H,b as R,w as A,d as e,e as G,H as b,I as w,t as x,p as Y,h as z}from"./index-829f29a1.js";import{m as J}from"./mainHeader-73d11f47.js";import{c as K}from"./camera-8cc3cd59.js";import{_ as Q,m as S}from"./plugin-vueexport-helper-140e9ddf.js";const r=d=>(Y("data-v-477ab940"),d=d(),z(),d),X={class:"page"},Z=["src"],$={class:"slider-section"},ee=r(()=>e("div",null,"How much food did you finish overall?",-1)),te={class:"flex justify-between"},ae={class:"slider-section"},se=r(()=>e("div",null,"How much rice/noodle did you finish?",-1)),le={class:"flex justify-between"},ne={class:"slider-section"},ie=r(()=>e("div",null,"How much vegetable did you finish?",-1)),oe={class:"flex justify-between"},ce={class:"slider-section"},re=r(()=>e("div",null,"How much meat did you finish?",-1)),de={class:"flex justify-between"},ue=r(()=>e("div",{class:"text-gray-400 text-xs mx-6"}," * For not applicable food type, please select 100% ",-1)),pe={__name:"Create",setup(d){const u=l(80),p=l(80),m=l(80),v=l(80),k=l();let C=null;const U=l(null),F=l(!1),j=()=>{U.value.click()},D=async a=>{let t=a.target.files[0];const n=await P(t,{quality:1,type:"image/jpeg"});k.value=URL.createObjectURL(t),C=n},P=async(a,{quality:t=1,type:n=a.type})=>new Promise((s,me)=>{let V=new FileReader;V.onloadend=function(M){var i=new Image;i.src=M.target.result,i.style.imageOrientation="from-image",i.onload=async function(ve){let{width:o,height:c}=i,f=400,_=400,h=o,g=c;(o>f||c>_)&&(o/c>f/_?(h=f,g=Math.round(f*(c/o))):(g=_,h=Math.round(_*(o/c))));var y=document.createElement("canvas");y.width=h,y.height=g;var O=y.getContext("2d");O.drawImage(i,0,0,h,g);const N=await new Promise(T=>y.toBlob(T,n,t));s(new File([N],a.name,{type:N.type}))}},V.readAsDataURL(a)}),B=W(),L=async()=>{if(C===null){S.error("Please take a photo first");return}F.value=!0;let a=new FormData;a.append("pic",C),a.append("rice",Number(p.value)),a.append("vegetable",Number(m.value)),a.append("meat",Number(v.value)),a.append("overall",Number(u.value));let t=await E("post","feedback",a,!0,{"Content-Type":"multipart/form-data"});F.value=!1,t.error===!1&&(S.success("successfully submitted!"),t.result.new_badge&&S.success("ðŸŽ‰You got new a badge!ðŸŽ‰"),B.push({path:"/"}))};return(a,t)=>{const n=q;return I(),H("div",X,[R(J),R(n,{spinning:F.value,tip:"submitting"},{default:A(()=>[e("input",{ref_key:"uploadFile",ref:U,type:"file",style:{display:"none"},accept:"image/*",capture:"camera",name:"file",onChange:D},null,544),k.value?(I(),H("img",{key:0,class:"pic-preview",src:k.value,onClick:j},null,8,Z)):(I(),H("div",{key:1,class:"pic-placehoder flex place-content-center",onClick:j},[R(G(K),{class:"camera-image place-self-center"})])),e("div",$,[ee,e("div",te,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),class:"slider overall place-self-center"},null,512),[[w,u.value]]),e("div",null,x(u.value)+"%",1)])]),e("div",ae,[se,e("div",le,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),class:"slider rice place-self-center"},null,512),[[w,p.value]]),e("div",null,x(p.value)+"%",1)])]),e("div",ne,[ie,e("div",oe,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),class:"slider vegetable place-self-center"},null,512),[[w,m.value]]),e("div",null,x(m.value)+"%",1)])]),e("div",ce,[re,e("div",de,[b(e("input",{type:"range",min:"1",max:"100","onUpdate:modelValue":t[3]||(t[3]=s=>v.value=s),class:"slider meat place-self-center"},null,512),[[w,v.value]]),e("div",null,x(v.value)+"%",1)])]),ue,e("div",{class:"btn m-auto text-white text-center font-bold",onClick:L}," Submit ")]),_:1},8,["spinning"])])}}},be=Q(pe,[["__scopeId","data-v-477ab940"]]);export{be as default};
